## 现状结论
- 后端已在 `POST /api/behavior/play` 时异步写入 `user_behavior`（`behaviorType=1`）作为播放流水；前端「我-观看历史」Tab 目前是占位文案，且后端缺少“按用户查询观看历史列表”的接口。

## 后端改造
- 新增“观看历史列表”接口：`GET /api/video/history?page=1&size=10`（需要登录）。
- 实现策略：基于 `user_behavior` 取 `behavior_type=1` 的记录，按“每个 videoId 取最近一次 create_time”去重后倒序分页（避免同一个视频多次观看导致历史重复）。
- Mapper 增强：在 `UserBehaviorMapper` 增加 2 个查询（可用注解 SQL 或新增 XML）：
  - `countDistinctPlayedVideos(userId)`：统计 `COUNT(DISTINCT video_id)`
  - `selectDistinctPlayedVideoIds(userId, offset, size)`：
    - `SELECT video_id FROM user_behavior WHERE user_id=? AND behavior_type=1 GROUP BY video_id ORDER BY MAX(create_time) DESC LIMIT ?,?`
- Service 增强：在 `IVideoService`/`VideoServiceImpl` 增加 `getHistoryVideos(userId, page, size)`，复用现有 `buildVideoVOs(videoIds,total)` 组装 `VideoVO`（保持顺序、批量补全作者/统计/交互状态）。
- Controller 增强：在 `VideoController` 增加 `@GetMapping("/history")`，从 `BaseContext.getCurrentId()` 取用户并返回 `Result<PageResult<VideoVO>>`。
- 兼容性检查（重要）：`user_behavior` 字段名在文档是 `behavior_type`，但仓库 SQL 备份里出现过 `favorite_type`；实现时会检查并决定是否需要在实体上加 `@TableField` 或提供迁移脚本（避免线上/本地环境列名不一致导致插入/查询失败）。

## 前端改造（frontend-web）
- 在 `services/videoService.ts` 增加 `getHistoryVideos(page,size)`，请求 `GET /api/video/history`，复用 `mapVideoVOToVideo`。
- 在 `app/me/page.tsx`：
  - 新增 `historyVideos` state
  - 在 `activeTab === "history"` 时拉取 `getHistoryVideos(1,20)`
  - History Tab 渲染复用现有 `VideoGrid`（空态文案改为“暂无观看历史”）。

## 可选增强（默认一并做，功能更完整）
- 增加清空历史：`DELETE /api/video/history`（删除当前用户 `behavior_type=1` 的记录）。
- 增加删除单条：`DELETE /api/video/history/{videoId}`（删除该用户该视频的播放历史）。
- 为查询性能补充索引（若仓库已有迁移目录则加入迁移；否则提供 SQL）：
  - `(user_id, behavior_type, create_time)`
  - 或 `(user_id, behavior_type, video_id, create_time)`

## 验证方式
- 不重复启动服务：用当前已运行的后端（8081）手动验证：
  - 先正常播放几个视频（前端已调用 `/api/behavior/play`）
  - 打开“我-观看历史”，应出现视频网格
  - 翻页/空态/删除单条/清空（若启用可选增强）验证接口返回与 UI 同步