**äºŒã€æ ¸å¿ƒè¡¨ä¸€è§ˆï¼ˆå…ˆç»™å…¨å±€ï¼‰**

| **è¡¨å**       | **ä½œç”¨**               |
|:---------------|:-----------------------|
| user           | ç”¨æˆ·ä¿¡æ¯               |
| admin          | ç®¡ç†å‘˜ä¿¡æ¯             |
| video          | çŸ­è§†é¢‘ä¿¡æ¯             |
| comment        | è¯„è®ºä¿¡æ¯               |
| video_like     | ç‚¹èµ                   |
| video_favorite | æ”¶è—                   |
| user_behavior  | ç”¨æˆ·è¡Œä¸ºè®°å½•           |
| video_stat     | è§†é¢‘ç»Ÿè®¡ï¼ˆå¯é€‰ä½†æ¨èï¼‰ |

**ä¸‰ã€æ•°æ®åº“å»ºè¡¨ SQLï¼ˆé‡ç‚¹ï¼‰**

**1ï¸âƒ£ ç”¨æˆ·è¡¨ user**

CREATE TABLE user (

id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç”¨æˆ·ID',

username VARCHAR(50) NOT NULL COMMENT 'ç”¨æˆ·å',

password VARCHAR(100) NOT NULL COMMENT 'å¯†ç ',

status TINYINT DEFAULT 0 COMMENT 'çŠ¶æ€ï¼š0æ­£å¸¸ 1å†»ç»“',

avatar VARCHAR(255) COMMENT 'å¤´åƒURL',

create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'æ³¨å†Œæ—¶é—´'

) COMMENT='ç”¨æˆ·è¡¨';

ğŸ“Œ æ”¯æ’‘æ¥å£ï¼š

- /user/register

- /user/login

- /admin/user/status

**2ï¸âƒ£ ç®¡ç†å‘˜è¡¨ admin**

CREATE TABLE admin (

id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç®¡ç†å‘˜ID',

username VARCHAR(50) NOT NULL,

password VARCHAR(100) NOT NULL,

create_time DATETIME DEFAULT CURRENT_TIMESTAMP

) COMMENT='ç®¡ç†å‘˜è¡¨';

ğŸ“Œ æ”¯æ’‘æ¥å£ï¼š

- /admin/login

**3ï¸âƒ£ è§†é¢‘è¡¨ video**

CREATE TABLE video (

id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'è§†é¢‘ID',

title VARCHAR(255) NOT NULL COMMENT 'è§†é¢‘æ ‡é¢˜',

video_url VARCHAR(255) NOT NULL COMMENT 'è§†é¢‘åœ°å€',

cover_url VARCHAR(255) COMMENT 'å°é¢å›¾',

description VARCHAR(255) COMMENT 'è§†é¢‘æè¿°',

uploader_id INT NOT NULL COMMENT 'ä¸Šä¼ ç”¨æˆ·ID',

status TINYINT DEFAULT 0 COMMENT 'çŠ¶æ€ï¼š0å¾…å®¡æ ¸ 1é€šè¿‡ 2æ‹’ç»',

is_hot TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦çƒ­é—¨ï¼š0å¦ 1æ˜¯',

is_deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤ï¼š0å¦ 1æ˜¯',

create_time DATETIME DEFAULT CURRENT_TIMESTAMP,

update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE
CURRENT_TIMESTAMP

) COMMENT='è§†é¢‘è¡¨';

ğŸ“Œ æ”¯æ’‘æ¥å£ï¼š

- /video/upload

- /video/list

- /admin/video/audit

- /admin/video/hot

- /admin/video/delete

**4ï¸âƒ£ è¯„è®ºè¡¨ comment**

CREATE TABLE comment (

id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'è¯„è®ºID',

video_id INT NOT NULL COMMENT 'è§†é¢‘ID',

user_id INT NOT NULL COMMENT 'ç”¨æˆ·ID',

content VARCHAR(500) NOT NULL COMMENT 'è¯„è®ºå†…å®¹',

status TINYINT DEFAULT 0 COMMENT 'çŠ¶æ€ï¼š0æ­£å¸¸ 1ç¦ç”¨',

create_time DATETIME DEFAULT CURRENT_TIMESTAMP

) COMMENT='è¯„è®ºè¡¨';

ğŸ“Œ æ”¯æ’‘æ¥å£ï¼š

- /behavior/comment

**5ï¸âƒ£ ç‚¹èµè¡¨ video_like**

CREATE TABLE video_like (

id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç‚¹èµID',

video_id INT NOT NULL,

user_id INT NOT NULL,

create_time DATETIME DEFAULT CURRENT_TIMESTAMP,

UNIQUE KEY uk_user_video (video_id, user_id)

) COMMENT='è§†é¢‘ç‚¹èµè¡¨';

ğŸ“Œ æ”¯æ’‘æ¥å£ï¼š

- /behavior/like

ğŸ‘‰ å”¯ä¸€ç´¢å¼•é˜²æ­¢é‡å¤ç‚¹èµï¼ˆå®è®­åŠ åˆ†ï¼‰

**6ï¸âƒ£ æ”¶è—è¡¨ video_favorite**

CREATE TABLE video_favorite (

id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'æ”¶è—ID',

video_id INT NOT NULL,

user_id INT NOT NULL,

create_time DATETIME DEFAULT CURRENT_TIMESTAMP,

UNIQUE KEY uk_user_video (video_id, user_id)

) COMMENT='è§†é¢‘æ”¶è—è¡¨';

ğŸ“Œ æ”¯æ’‘æ¥å£ï¼š

- /behavior/favoriteï¼ˆæˆ–æ”¶è—æ¥å£ï¼‰

**7ï¸âƒ£ ç”¨æˆ·è¡Œä¸ºè¡¨ user_behaviorï¼ˆæ¨èæ ¸å¿ƒï¼‰**

CREATE TABLE user_behavior (

id INT PRIMARY KEY AUTO_INCREMENT COMMENT 'è¡Œä¸ºID',

user_id INT NOT NULL COMMENT 'ç”¨æˆ·ID',

video_id INT NOT NULL COMMENT 'è§†é¢‘ID',

behavior_type TINYINT NOT NULL COMMENT '1æ’­æ”¾ 2ç‚¹èµ 3æ”¶è— 4è¯„è®º',

create_time DATETIME DEFAULT CURRENT_TIMESTAMP

) COMMENT='ç”¨æˆ·è¡Œä¸ºè®°å½•è¡¨';

ğŸ“Œ æ”¯æ’‘æ¥å£ï¼š

- /video/play

- /behavior/\*

- /recommend/\*

- /analysis/video

ğŸ‘‰ **æ¨èç®—æ³• & è¡Œä¸ºåˆ†æå…¨é å®ƒ**

**8ï¸âƒ£ è§†é¢‘ç»Ÿè®¡è¡¨ video_statï¼ˆå¯é€‰ä½†å¼ºçƒˆæ¨èï¼‰**

CREATE TABLE video_stat (

video_id INT PRIMARY KEY COMMENT 'è§†é¢‘ID',

play_count INT DEFAULT 0,

like_count INT DEFAULT 0,

comment_count INT DEFAULT 0,

favorite_count INT DEFAULT 0,

update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE
CURRENT_TIMESTAMP

) COMMENT='è§†é¢‘ç»Ÿè®¡è¡¨';

ğŸ“Œ ç”¨äºï¼š

- çƒ­é—¨æ’è¡Œ

- æ•°æ®åˆ†æ

- å‡å°‘å¤§é‡ COUNT æŸ¥è¯¢ï¼ˆå·¥ç¨‹åŠ åˆ†ï¼‰

**å››ã€æ¥å£ â†” æ•°æ®åº“å®Œæ•´æ˜ å°„**

| **æ¥å£**    | **è¡¨**                     |
|:------------|:---------------------------|
| æ³¨å†Œ / ç™»å½• | user                       |
| è§†é¢‘ä¸Šä¼     | video                      |
| æ’­æ”¾        | user_behavior + video_stat |
| ç‚¹èµ        | video_like + user_behavior |
| è¯„è®º        | comment + user_behavior    |
| çƒ­é—¨æ¨è    | video_stat + video         |
| ç®¡ç†å®¡æ ¸    | video                      |
